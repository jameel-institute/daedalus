<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Exploring uncertainty in pandemic costs due to parameter uncertainty • daedalus</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Inter-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Exploring uncertainty in pandemic costs due to parameter uncertainty">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://www.imperial.ac.uk/jameel-institute/" class="external-link"><img src="https://raw.githubusercontent.com/jameel-institute/jameelinst.rpkg.theme/refs/heads/main/inst/pkgdown/assets/logo_imperial_jameel.svg" id="logo" alt="Abdul Latif Jameel Institute for Disease and Emergency Analytics"></a>
    <a class="navbar-brand me-2" href="../index.html">daedalus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/daedalus.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Package vignettes and user guides</h6></li>
    <li><a class="dropdown-item" href="../articles/thresholded_response.html">Modelling threshold-dependent economic closures</a></li>
    <li><a class="dropdown-item" href="../articles/pandemic_costs.html">Evaluating the costs of pandemic scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/parameter_uncertainty.html">Exploring uncertainty in pandemic costs due to parameter uncertainty</a></li>
    <li><a class="dropdown-item" href="../articles/strategy_comparison.html">Comparing response strategies under uncertainty and valuations</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Model details: Calculating pandemic costs</h6></li>
    <li><a class="dropdown-item" href="../articles/info_life_value.html">Value of life-years lost</a></li>
    <li><a class="dropdown-item" href="../articles/info_edu_value.html">Value of educational time lost</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jameel-institute/daedalus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Exploring uncertainty in pandemic costs due to parameter uncertainty</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jameel-institute/daedalus/blob/main/vignettes/parameter_uncertainty.Rmd" class="external-link"><code>vignettes/parameter_uncertainty.Rmd</code></a></small>
      <div class="d-none name"><code>parameter_uncertainty.Rmd</code></div>
    </div>

    
    
<p>This vignette shows how to explore the effect of model parameter
uncertainty on epidemic costs using <em>daedalus</em>.</p>
<p>Here we explore the effect of uncertainty in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>,
which is a common use case in the initial stages of a novel pandemic
when estimates of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
are less robust.</p>
<p>We shall model uncertainty in a scenario of a SARS-2004 like
infection outbreak in a country chosen at random, Norway.</p>
<p>We focus on infection parameter uncertainty, but a similar approach
can be applied to country characteristics.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load {daedalus} and helper packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jameel-institute/daedalus" class="external-link">daedalus</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/" class="external-link">ggdist</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="general-approach">General approach<a class="anchor" aria-label="anchor" href="#general-approach"></a>
</h2>
<p>The general approach is:</p>
<ul>
<li><p>Create multiple <code>&lt;daedalus_infection&gt;</code> objects
with distinct values of parameters;</p></li>
<li><p>Run <code><a href="../reference/daedalus.html">daedalus()</a></code> on each distinct
<code>&lt;daedalus_infection&gt;</code> object;</p></li>
<li><p>Get costs from each model output object.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="drawing-parameters-from-a-distribution">Drawing parameters from a distribution<a class="anchor" aria-label="anchor" href="#drawing-parameters-from-a-distribution"></a>
</h2>
<p>First, we access the SARS 2004
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
provided in <em>daedalus</em>, and using this as a mean we draw 100
samples from a normal distribution with a standard deviation of 0.1.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get SARS-1 R0</span></span>
<span><span class="va">sars_2004</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/class_infection.html">daedalus_infection</a></span><span class="op">(</span><span class="st">"sars_cov_1"</span><span class="op">)</span></span>
<span><span class="va">sars_2004_r0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_data.html">get_data</a></span><span class="op">(</span><span class="va">sars_2004</span>, <span class="st">"r0"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># draw samples from a normal distribution</span></span>
<span><span class="va">r0_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">sars_2004_r0</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-infection-objects">Create infection objects<a class="anchor" aria-label="anchor" href="#create-infection-objects"></a>
</h2>
<p>Next we create <code>&lt;daedalus_infection&gt;</code> objects to
hold the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
values.</p>
<p><strong>Note that</strong> future versions of <em>daedalus</em> will
include better support for parameter uncertainty, such as that provided
by the <a href="https://cran.r-project.org/package=distributional" class="external-link"><em>distributional</em>
package</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make a list of infection objects</span></span>
<span><span class="va">infection_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  <span class="va">r0_samples</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/class_infection.html">daedalus_infection</a></span><span class="op">(</span><span class="st">"sars_cov_1"</span>, r0 <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View an infection object</span></span>
<span><span class="va">infection_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;daedalus_infection&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> Epidemic name: <span style="font-weight: bold;">sars_cov_1</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> R0: <span style="color: #BB0000;">1.68735461892577</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> sigma: <span style="color: #0000BB;">0.217</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> p_sigma: <span style="color: #0000BB;">0.867</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> epsilon: <span style="color: #0000BB;">0.58</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> rho: <span style="color: #0000BB;">0.003</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> eta: <span style="color: #0000BB;">0.018</span>, <span style="color: #0000BB;">0.082</span>, <span style="color: #0000BB;">0.018</span>, and <span style="color: #0000BB;">0.246</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> omega: <span style="color: #0000BB;">0.012</span>, <span style="color: #0000BB;">0.012</span>, <span style="color: #0000BB;">0.012</span>, and <span style="color: #0000BB;">0.012</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> gamma_Ia: <span style="color: #0000BB;">0.476</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> gamma_Is: <span style="color: #0000BB;">0.25</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> gamma_H: <span style="color: #0000BB;">0.034</span>, <span style="color: #0000BB;">0.034</span>, <span style="color: #0000BB;">0.034</span>, and <span style="color: #0000BB;">0.034</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-daedalus-model-for-each-infection-object">Run DAEDALUS model for each infection object<a class="anchor" aria-label="anchor" href="#run-daedalus-model-for-each-infection-object"></a>
</h2>
<p>We run the model for Norway with each infection object, representing
different values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>.</p>
<p>We assume that there is no vaccine investment in advance of the
outbreak. Vaccination with a pathogen specific vaccine is thus assumed
to begin 1 year after the epidemic start date, similar to the situation
for Covid-19.</p>
<p>We also assume for this example that this outbreak is unmitigated and
allowed to become an epidemic.</p>
<p>The model runs for 600 days or a little over 1.5 years.</p>
<p><strong>Note that</strong> running <code><a href="../reference/daedalus.html">daedalus()</a></code>
iteratively may take some time, as the function checks the inputs and
internally prepares parameters each time, as well as preparing the
output data. Future package versions aim to streamline these steps and
provide a stripped down version of the function optimised for scenario
modelling for parameter fitting or with parameter uncertainty.</p>
<p>Users can run the model iteratively over the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>
samples in parallel using frameworks such as <a href="https://cran.r-project.org/package=furrr" class="external-link">the <em>furrr</em>
package</a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># run daedalus()</span></span>
<span><span class="va">output_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  <span class="va">infection_list</span>, <span class="va">daedalus</span>,</span>
<span>  country <span class="op">=</span> <span class="st">"Norway"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get-epidemic-costs">Get epidemic costs<a class="anchor" aria-label="anchor" href="#get-epidemic-costs"></a>
</h2>
<p>We can get the total epidemic costs — a combination of life years
lost, educational losses leading to lost future earnings, and economic
losses due to worker illness — using the helper function
<code><a href="../reference/get_costs.html">get_costs()</a></code> and passing the option
<code>summarise_as = "total"</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get costs</span></span>
<span><span class="va">costs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span></span>
<span>  <span class="va">output_list</span>, <span class="va">get_costs</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="st">"total"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can plot the total costs to view the distribution using the <a href="https://cran.r-project.org/package=ggdist" class="external-link"><em>ggdist</em>
package</a> to visualise the distribution.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use {ggplot2} to visualise the output</span></span>
<span><span class="co"># `stat_histinterval()` is from {ggdist}</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/stat_histinterval.html" class="external-link">stat_histinterval</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">costs</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"steelblue"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma_format</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://mjskay.github.io/ggdist/reference/theme_ggdist.html" class="external-link">theme_tidybayes</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Overall epidemic cost (million $)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="parameter_uncertainty_files/figure-html/plot_total_costs_dist-1.png" width="768"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pratik Gupte, Patrick Doohan, Robert Johnson, Rich FitzJohn, Emma Russell, David Mears, Katharina Hauck, Abdul Latif Jameel Institute for Disease and Emergency Analytics, Imperial College of Science, Technology and Medicine.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
